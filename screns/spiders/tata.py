
import scrapy
from scrapy import FormRequest

class TataSpider(scrapy.Spider):
    name = "tata"
    allowed_domains = ["www.screener.in"]
    tiker_list = ["ARVEE", "SUBROS", "BAGFILMS", "MANOMAY", "STEELCAS", "ARSHIYA", "AMBICAAGAR", "BHAGYANGR", "MHLXMIRU", "AAKASH", "FCSSOFT", "ACL", "PALREDTEC", "LCCINFOTEC", "CYBERMEDIA", "DELTAMAGNT", "NILASPACES", "LYPSAGEMS", "MOHITIND", "SUPREMEENG", "CENTEXT", "URAVI", "SILGO", "RCOM", "KAMATHOTEL", "BEDMUTHA", "REFEX", "ASIANENE", "PRITI", "63MOONS", "V2RETAIL", "ELGIRUBCO", "GMRP&UI", "ATAM", "ZENITHEXPO", "HPIL", "WEL", "ICDSLTD", "CROWN", "MUFIN", "SKIL", "KARMAENG", "JETAIRWAYS", "MDL", "NKIND", "LLOYDSENGG", "HECPROJECT", "PARACABLES", "RUCHINFRA", "IL&FSENGG", "ANSALAPI", "RELCAPITAL", "GVKPIL", "SILLYMONKS", "UNITECH", "SUULD", "VARDMNPOLY", "KSHITIJPOL", "STEL", "FLEXITUFF", "DUCON", "ACCURACY", "KAUSHALYA", "ARENTERP", "MBECL", "SHRENIK", "GTLINFRA", "LAL", "TIPSFILMS", "GUJRAFFIA", "MMP", "IREDA", "HDIL", "OILCOUNTUB", "AAATECH", "HAVISHA", "PRITIKAUTO", "KCPSUGIND", "BANG", "MOKSH", "TECHIN", "UMAEXPORTS", "RHFL", "MAZDOCK", "ESSARSHPNG", "PURVA", "SAREGAMA", "UTTAMSUGAR", "SMCGLOBAL", "BSHSL", "WALCHANNAG", "EDUCOMP", "ZEEMEDIA", "DNAMEDIA", "SABEVENTS", "CUBEXTUB", "GMRINFRA", "LLOYDSME", "PRECOT", "SEJALLTD", "LOTUSEYE", "IVC", "KRITINUT", "TPHQ", "MEDICO", "ARTNIRMAN", "OMKARCHEM", "NEWGEN", "PNC", "FMNL", "INDRAMEDCO", "KANANIIND", "FRETAIL", "JASH", "NRBBEARING", "ZODIAC", "MORARJEE", "DHUNINV", "GET&D", "CHEVIOT", "HINDCON", "CHOICEIN", "BROOKS", "DCMSRIND", "QUINTEGRA", "SOMATEX", "VIJIFIN", "AIRAN", "DANGEE", "OSWALSEEDS", "LATTEYS", "SINDHUTRAD", "ASPINWALL", "SECMARK", "GLOBALVECT", "HMVL", "NEXTMEDIA", "AARVI", "CALSOFT", "BLBLIMITED", "AUTOIND", "RMCL", "LGBFORGE", "GOKUL", "ICEMAKE", "KIOCL", "DCBBANK", "GLOBAL", "ANUP", "NECCLTD", "SPENCERS", "AMJLAND", "JBMA", "MITTAL", "SOMICONVEY", "HONDAPOWER", "SAMBHAAV", "CENTUM", "ALPA", "SURANASOL", "RPPL", "TNPETRO", "ALOKINDS", "KBCGLOBAL", "ADL", "SUPRIYA", "MODISONLTD", "HILTON", "SUVIDHAA", "MTEDUCARE", "ALPSINDUS", "TEMBO", "KANPRPLA", "ESSENTIA", "NETWEB", "PRAKASHSTL", "GRAVITA", "FSC", "AXITA", "SERVOTECH", "GENCON", "KAVVERITEL", "TAKE", "SHREYANIND", "MBLINFRA", "SHIVAMILLS", "LOKESHMACH", "AGRITECH", "GREENLAM", "MICEL", "BCG", "ONELIFECAP", "UNIVASTU", "CAPTRUST", "AGROPHOS", "SURANAT&P", "ZODIACLOTH", "AVONMORE", "GOYALALUM", "JAYNECOIND", "ANMOL", "CONSOFINVT", "GREENPOWER", "ANANDRATHI", "IGARASHI", "ANANTRAJ", "NSIL", "ASHOKAMET", "TEXMOPIPES", "PAYTM", "SIKKO", "CANTABIL", "VASWANI", "AAVAS", "ACEINTEG", "STEELXIND", "ELDEHSG", "JWL", "MARALOVER", "ALANKIT", "UJJIVANSFB", "ATGL", "KAPSTON", "BIGBLOC", "DYCL", "LAGNAM", "KOKUYOCMLN", "JITFINFRA", "PCJEWELLER", "HOVS", "UNITEDPOLY", "CENTRUM", "CYIENT", "KREBSBIO", "DCM", "ALKALI", "INDOSTAR", "BSL", "RANEENGINE", "RSSOFTWARE", "NDLVENTURE", "AMDIND", "21STCENMGM", "BIRLACABLE", "PATELENG", "JHS", "SEPC", "TALBROAUTO", "VARDHACRLC", "SBFC", "MIRZAINT", "TIDEWATER", "AARVEEDEN", "VINEETLAB", "PDSL", "HINDCOMPOS", "LAMBODHARA", "ASTEC", "HPAL", "TVTODAY", "AMBER", "SHAHALLOYS", "CREST", "RPOWER", "EASTSILK", "WELENT", "DICIND", "TAINWALCHM", "GMMPFAUDLR", "FMGOETZE", "JINDALPHOT", "SUPERSPIN", "TATVA", "RADIOCITY", "HEXATRADEX", "FOCUS", "ENERGYDEV", "PFS", "INDSWFTLAB", "RESPONIND", "NITCO", "HLVLTD", "NINSYS", "VIRINCHI", "MARSHALL", "DHARMAJ", "ZENTEC", "GATECHDVR", "GENESYS", "SHAH", "PSPPROJECT", "SUNDARMHLD", "SONATSOFTW", "VIKASECO", "PAVNAIND", "MVGJL", "TPLPLASTEH", "DPWIRES", "NITINSPIN", "MUTHOOTCAP", "AGI", "UCAL", "AURUM", "DIAMONDYD", "THEJO", "SIGMA", "ECLERX", "CENTURYPLY", "JAIBALAJI", "BCLIND", "ASAHISONG", "IFBAGRO", "VALIANTORG", "NSLNISP", "MANORAMA", "APTUS", "RAMANEWS", "NAGAFERT", "GRPLTD", "MALLCOM", "GANDHITUBE", "PRECWIRE", "CORALFINAC", "GSS", "AKSHARCHEM", "ARIHANTCAP", "SIMBHALS", "MANAKALUCO", "EIHOTEL", "INDOAMIN", "MAXHEALTH", "TOTAL", "GVPTECH", "BHARATGEAR", "ONEPOINT", "MAXESTATES", "BRNL", "CEREBRAINT", "OSIAHYPER", "INSECTICID", "OBCL", "TRIVENI", "XCHANGING", "FAZE3Q", "SPANDANA", "PRIMESECU", "JTLIND", "FIBERWEB", "LOVABLE", "CUB", "PATANJALI", "PNBGILTS", "IMAGICAA", "WENDT", "SGL", "PONNIERODE", "PRAKASH", "RAMKY", "PIGL", "CREATIVE", "TV18BRDCST", "TARC", "EVEREADY", "ESTER", "KPRMILL", "SHRIPISTON", "SANDUMA", "SALSTEEL", "SIS", "AIROLAM", "SYNCOMF", "TATAINVEST", "SDBL", "MMTC", "BBTC", "IFBIND", "MANAKSIA", "SGIL", "DBOL", "PLASTIBLEN", "PRICOLLTD", "BLS", "ALMONDZ", "ORIENTLTD", "SANGHVIMOV", "ISMTLTD", "UNIVCABLES", "INDIACEM", "ARVSMART", "IBREALEST", "APCOTEXIND", "MAHLOG", "VALIANTLAB", "EIHAHOTELS", "RELIGARE", "ASHIMASYN", "COMPINFO", "20MICRONS", "OSWALAGRO", "PNBHOUSING", "CENTURYTEX", "XPROINDIA", "LINDEINDIA", "RADICO", "MITCON", "CTE", "IMPAL", "TNPL", "SAGARDEEP", "KICL", "JBCHEPHARM", "RANEHOLDIN", "PITTIENG", "GANESHHOUC", "SUMMITSEC", "DEVYANI", "MINDTECK", "JINDWORLD", "BIRLAMONEY", "MANAKSTEEL", "RAJMET", "RML", "INGERRAND", "IVP", "CRAFTSMAN", "TRU", "METROBRAND", "UMANGDAIRY", "ROSSELLIND", "SPCENET", "JSL", "VIPCLOTHNG", "ALLCARGO", "POLYMED", "MAZDA", "JKIL", "RTNPOWER", "SMLISUZU", "MEGASTAR", "YASHO", "ICRA", "EQUITASBNK", "DPSCLTD", "JAYSREETEA", "EPIGRAL", "OLECTRA", "INTLCONV", "SPAL", "PILANIINVS", "AJOONI", "GATECHDVR", "GEPIL", "CHOLAHLDNG", "NEOGEN", "ASALCBR", "LEXUS", "HAPPSTMNDS", "AKSHOPTFBR", "IIFL", "INNOVATIVE", "ANGELONE", "JSWHL", "SBC", "VIKASLIFE", "TITAGARH", "GRINFRA", "SARLAPOLY", "INDIANHUME", "RBL", "RITCO", "YUKEN", "GOCOLORS", "SHIVALIK", "NH", "ARCHIES", "GREAVESCOT", "SANSERA", "MSUMI", "YAARI", "SHYAMMETL", "VEDL", "TRIDENT", "KSL", "SWELECTES", "FEDFINA", "WHIRLPOOL", "HGINFRA", "QUICKHEAL", "BPCL", "IEL", "MUNJALAU", "PREMEXPLN", "LUMAXTECH", "IOC", "ZYDUSLIFE", "HONAUT", "MAITHANALL", "SIL", "THANGAMAYL", "ASAHIINDIA", "LUXIND", "STARTECK", "NUVAMA", "EASEMYTRIP", "OMAXE", "ELGIEQUIP", "HGS", "FINOPB", "MAXIND", "SURYAROSNI", "WEBELSOLAR", "PATINTLOG", "GLOBUSSPR", "ALICON", "GANECOS", "ITDC", "KANORICHEM", "GEOJITFSL", "GANDHAR", "ADORWELD", "SAMHI", "ADFFOODS", "APCL", "SHANTIGEAR", "NHPC", "TIPSINDLTD", "BEARDSELL", "TIINDIA", "VSTTILLERS", "HITECH", "JINDRILL", "GMBREW", "DECCANCE", "UFO", "GSLSU", "RAYMOND", "URJA", "ORISSAMINE", "ASTRAZEN", "ANDHRAPAP", "PAISALO", "FLAIR", "BTML", "TATACHEM", "TEGA", "KPIGREEN", "VERANDA", "MEP", "SOLARINDS", "SUNTV", "VLSFINANCE", "CAPACITE", "MIRCELECTR", "LTFOODS", "STAR", "STARCEMENT", "SUDARSCHEM", "HITECHGEAR", "JTEKTINDIA", "MUKTAARTS", "SOBHA", "BLAL", "MGL", "ENGINERSIN", "IFGLEXPOR", "ARIHANTSUP", "SHAKTIPUMP", "SMLT", "RELINFRA", "ENIL", "ATULAUTO", "MARATHON", "SASTASUNDR", "HATHWAY", "TVSELECT", "BRIGADE", "GOKULAGRO", "NAHARINDUS", "SHREECEM", "STYLAMIND", "KIRLOSENG", "PARAGMILK", "JPASSOCIAT", "RSYSTEMS", "HINDWAREAP", "TECHNOE", "ARTEMISMED", "KTKBANK", "RATEGAIN", "AGSTRA", "GODREJAGRO", "TEXINFRA", "CYBERTECH", "HIL", "3PLAND", "ATL", "SATINDLTD", "GALLANTT", "BALMLAWRIE", "APARINDS", "FILATEX", "EDELWEISS", "FUSION", "TCNSBRANDS", "RUPA", "AXISCADES", "ADVANIHOTR", "AMBUJACEM", "SHYAMCENT", "LTTS", "KITEX", "AMRUTANJAN", "ZFCVINDIA", "JSWINFRA", "DLF", "PSB", "RELCHEMQ", "MCX", "BLKASHYAP", "NAVA", "NAZARA", "RBA", "ENDURANCE", "ASTERDM", "NAHARSPING", "CAREERP", "SBICARD", "PASUPTAC", "KRSNAA", "GAYAPROJ", "DBREALTY", "IGL", "GICHSGFIN", "INDOWIND", "SHAREINDIA", "MAHLIFE", "LAXMIMACH", "MANALIPETC", "EMSLIMITED", "PANAMAPET", "KIRLOSIND", "HINDPETRO", "BEL", "MTARTECH", "IWEL", "INDIGO", "ABB", "SURYODAY", "TORNTPOWER", "OIL", "LAXMICOT", "USK", "SUNFLAG", "GULFPETRO", "RPGLIFE", "SATIN", "VBL", "CLSEL", "AARTECH", "ASKAUTOLTD", "ZOTA", "VINATIORGA", "MANINDS", "INTENTECH", "RUCHIRA", "MCLEODRUSS", "DCW", "GEECEE", "ASTRAL", "CAPLIPOINT", "PRESTIGE", "MANGCHEFER", "UNIPARTS", "SELAN", "PYRAMID", "GSFC", "INDIGRID", "GLS", "TRENT", "BLISSGVS", "REPL", "ONMOBILE", "SBGLP", "ABCAPITAL", "STEELCITY", "JCHAC", "HBLPOWER", "KALAMANDIR", "DAMODARIND", "RADIANTCMS", "WSTCSTPAPR", "IDBI", "REDTAPE", "SARDAEN", "TEJASNET", "NOCIL", "VSTIND", "KHAICHEM", "ACE", "ESCORTS", "HNDFDS", "HEMIPROP", "HINDMOTORS", "ZAGGLE", "SCI", "PNCINFRA", "SOMANYCERA", "PTC", "PTL", "UTIAMC", "UTKARSHBNK", "PHOENIXLTD", "DODLA", "MOTHERSON", "TBZ", "THYROCARE", "RTNINDIA", "TATAPOWER", "NDTV", "ADANIENSOL", "KPITTECH", "CEATLTD", "CHENNPETRO", "COCHINSHIP", "VAIBHAVGBL", "CELEBRITY", "ONGC", "KPIL", "DENORA", "DIL", "TERASOFT", "ABBOTINDIA", "INDUSTOWER", "HCL-INSYS", "PERSISTENT", "AEROFLEX", "ANIKINDS", "DATAMATICS", "NLCINDIA", "PETRONET", "ACLGATI", "GRSE", "DELTACORP", "PARAS", "BANARBEADS", "DELHIVERY", "SANGAMIND", "DJML", "BLUEJET", "EMUDHRA", "KAYNES", "PAR", "SATIA", "SELMC", "MAHABANK", "TATATECH", "CRISIL", "AKG", "AVROIND", "NRL", "CASTROLIND", "AUBANK", "ZIMLAB", "LIKHITHA", "SAPPHIRE", "TRF", "CAMPUS", "MOLDTKPAC", "KFINTECH", "MOIL", "TARMAT", "ADANIENT", "TIMKEN", "RHIM"]

    def start_requests(self):
        for tiker in self.tiker_list:
            url = f"https://www.screener.in/company/{tiker}/consolidated/"
            yield scrapy.Request(url, callback=self.parse, meta={'ticker': tiker})

    def parse(self, response):
        ticker = response.meta['ticker']
        tlist = response.xpath('//li[@class="flex flex-space-between"]')
        for box in tlist:
            name = box.xpath('.//span[1]/text()').get().strip()  # Remove leading and trailing whitespaces
            value = [v.strip() for v in box.xpath('.//span[2]/span/text()').getall()]  # Remove leading and trailing whitespaces from each value
            yield {
                'ticker': ticker,
                'name': name,
                'value': value
            }